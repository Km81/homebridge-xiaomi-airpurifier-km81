{
  "pluginAlias": "XiaomiAirPurifierPlatform",
  "pluginType": "platform",
  "singular": true,
  "schema": {
    "type": "object",
    "properties": {
      "name": {
        "title": "플랫폼 이름",
        "type": "string",
        "default": "Xiaomi Air Purifier"
      },
      "devices": {
        "title": "디바이스 목록",
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "name": { "title": "이름", "type": "string" },
            "ip": { "title": "IP 주소", "type": "string" },
            "token": { "title": "토큰", "type": "string" },
            "type": {
              "title": "모델 타입",
              "type": "string",
              "enum": ["MiAirPurifier2S", "MiAirPurifierPro"],
              "default": "MiAirPurifier2S"
            },
            "model": { "title": "모델(선택)", "type": "string" },
            "pollingInterval": {
              "title": "폴링 간격(ms)",
              "type": "integer",
              "default": 15000,
              "minimum": 3000
            },

            "showLED": { "title": "LED 스위치 표시", "type": "boolean", "default": true },
            "separateLedAccessory": { "title": "LED를 별도 악세서리로", "type": "boolean", "default": false },
            "ledName": { "title": "LED 이름(선택)", "type": "string" },

            "showBuzzer": { "title": "버저 스위치 표시", "type": "boolean", "default": true },
            "separateBuzzerAccessory": { "title": "버저를 별도 악세서리로", "type": "boolean", "default": false },
            "buzzerName": { "title": "버저 이름(선택)", "type": "string" },

            "showAutoModeSwitch": { "title": "Auto 모드 스위치 표시", "type": "boolean", "default": true },
            "separateAutoModeAccessory": { "title": "Auto를 별도 악세서리로", "type": "boolean", "default": false },
            "autoModeName": { "title": "Auto 이름(선택)", "type": "string" },

            "showSleepModeSwitch": { "title": "Sleep 모드 스위치 표시", "type": "boolean", "default": true },
            "separateSleepModeAccessory": { "title": "Sleep을 별도 악세서리로", "type": "boolean", "default": false },
            "sleepModeName": { "title": "Sleep 이름(선택)", "type": "string" },

            "showFavoriteModeSwitch": { "title": "Favorite 모드 스위치 표시", "type": "boolean", "default": true },
            "separateFavoriteModeAccessory": { "title": "Favorite을 별도 악세서리로", "type": "boolean", "default": false },
            "favoriteModeName": { "title": "Favorite 이름(선택)", "type": "string" },

            "favoriteMin": { "title": "Favorite 최소 레벨", "type": "integer", "default": 1, "minimum": 1 },
            "favoriteMax": { "title": "Favorite 최대 레벨", "type": "integer", "default": 16, "minimum": 1 },
            "aqiThresholds": {
              "title": "AQI 등급 경계값 [우수, 좋음, 보통, 나쁨]",
              "type": "string",
              "default": "15,35,75,115",
              "description": "쉼표로 구분된 4개 숫자. 예: 15,35,75,115"
            }
          },
          "required": ["ip", "token"]
        }
      }
    }
  },
  "display": {
    "headerDisplay": "### 샤오미 공기청정기 (KM81)\nHome 앱에서 전원/모드/속도 변경 시 **즉시 반영**되며, 폴링으로 실상태를 주기적으로 동기화합니다.",
    "footerDisplay": "_by Km81_"
  },
  "form": [
    "name",
    {
      "key": "devices",
      "type": "array",
      "title": "디바이스",
      "items": [
        "devices[].name",
        "devices[].ip",
        "devices[].token",
        "devices[].type",
        "devices[].model",
        "devices[].pollingInterval",
        {
          "type": "fieldset",
          "title": "스위치/모드 표시 설정",
          "expandable": true,
          "items": [
            "devices[].showLED",
            "devices[].separateLedAccessory",
            "devices[].ledName",
            "devices[].showBuzzer",
            "devices[].separateBuzzerAccessory",
            "devices[].buzzerName",
            "devices[].showAutoModeSwitch",
            "devices[].separateAutoModeAccessory",
            "devices[].autoModeName",
            "devices[].showSleepModeSwitch",
            "devices[].separateSleepModeAccessory",
            "devices[].sleepModeName",
            "devices[].showFavoriteModeSwitch",
            "devices[].separateFavoriteModeAccessory",
            "devices[].favoriteModeName"
          ]
        },
        {
          "type": "fieldset",
          "title": "Favorite & AQI",
          "expandable": true,
          "items": [
            "devices[].favoriteMin",
            "devices[].favoriteMax",
            "devices[].aqiThresholds"
          ]
        }
      ]
    }
  ]
}
